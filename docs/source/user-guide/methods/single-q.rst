.. _user-guide_methods_single-q:

**********************
Single-q conical state
**********************

.. dropdown:: Notation used on this page

  * .. include:: page-notations/vector.txt
  * .. include:: page-notations/matrix.txt
  * .. include:: page-notations/bra-ket.txt
  * .. include:: page-notations/in-uvn.txt
  * .. include:: page-notations/parentheses.txt

Description of the atomic spin lattice
======================================
We define a Bravais lattice with primitve vectors
:math:`\{\boldsymbol{a_1},\boldsymbol{a_2},\boldsymbol{a_3}\}`.
The Bravais lattice is composed of :math:`M` cells whose positions are given by

.. math::
  \boldsymbol{r_m} = m_1\,\boldsymbol{a_1} + m_2\,\boldsymbol{a_2} + m_3\,\boldsymbol{a_3}

Each cell contains :math:`I` atoms with intra-cell positions :math:`\boldsymbol{r_i}`
and overall positions

.. math::
  \boldsymbol{r_{mi}} = \boldsymbol{r_m} + \boldsymbol{r_i}

Then a spin vector :math:`\boldsymbol{S_{mi}}` is placed at each atomic site.

Cone angles and rotation matrix
===============================
A single-:math:`\boldsymbol{q}` conical spin state can be described by two vectors

* The cone axis direction is defined by the unit vector :math:`\boldsymbol{\hat{n}}`.
  Magnopy uses the so-called :math:`(\,u\,v\,n\,)` reference frame as described in
  :ref:`user-guide_methods_uvn-choice`, where :math:`\boldsymbol{\hat{n}}`
  is the cone axis.
* A pitch vector :math:`\boldsymbol{q}` that defines the spiral propagation through
  the azimut phase :math:`\phi_m = \boldsymbol{q}\cdot\boldsymbol{r_m}`.

Both vector define the cone-state rotation matrix

.. include:: repeated-formulas/spiral-rotation-matrix-uvn.txt

Intratomic spins
================
Magnopy lets all the :math:`I` intra-cell spins :math:`i` have independent orientations.
These orientations are described by the angles :math:`\theta_i` and :math:`\phi_i` as
formulated in :ref:`here <user-guide_methods_spin-rotations>`.

Full spin rotation matrix
=========================
The single-:math:`\boldsymbol{q}` spin state is generated by applying
a rotation

.. include:: repeated-formulas/spin-from-ferro-any.txt


where we recall

.. include:: repeated-formulas/spin-rotation-matrix-uvn.txt

In other words we absorb the in-cell spiral contribution :math:`\boldsymbol{q}\cdot\boldsymbol{r_i}`
into the angle :math:`\phi_i`

Matrix :math:`\boldsymbol{R_{mi}}` has the form:

.. math::
  \boldsymbol{R_{mi}}
  =
  \begin{pmatrix}
    ... & ... & \sin\theta_i\cos(\boldsymbol{q}\cdot\boldsymbol{r_m} + \phi_i)     \\
    ... & ... & \sin\theta_i\sin(\boldsymbol{q}\cdot\boldsymbol{r_m} + \phi_i)     \\
    -\cos\phi_i\sin\theta_i & -\sin\phi_i\sin\theta_i & \cos\theta_i \\
  \end{pmatrix}

And the spin :math:`\boldsymbol{S_{mi}}` is

.. include:: repeated-formulas/spin-uvn.txt

.. dropdown:: All elements of the matrix  :math:`\text{ }\boldsymbol{R_{mi}}`

  For simplicity of the notation we call the matrix :math:`\boldsymbol{R_{mi}}`
  as :math:`\boldsymbol{R}`:

  .. math::
    \boldsymbol{R_{mi}}
    =
    \boldsymbol{R}
    =
    \begin{pmatrix}
      R^{11} & R^{12} & R^{13} \\
      R^{21} & R^{22} & R^{23} \\
      R^{31} & R^{32} & R^{33} \\
    \end{pmatrix}

  .. math::
    &R^{11}
    =
    \cos(\boldsymbol{q}\cdot\boldsymbol{r_m})\left[\cos\theta_i + \sin^2\phi_i(1-\cos\theta_i)\right]-\sin(\boldsymbol{q}\cdot\boldsymbol{r_m})\left[-\sin\phi_i\cos\phi_i(1-\cos\theta_i)\right]
    =\\&=
    (1-\cos\theta_i)\left[\cos(\boldsymbol{q}\cdot\boldsymbol{r_m})\sin^2\phi_i+\sin(\boldsymbol{q}\cdot\boldsymbol{r_m})\sin\phi_i\cos\phi_i\right]+\cos(\boldsymbol{q}\cdot\boldsymbol{r_m})\cos\theta_i
    =\\&=
    (1-\cos\theta_i)\sin\phi_i\sin(\boldsymbol{q}\cdot\boldsymbol{r_m}+\phi_i)+\cos(\boldsymbol{q}\cdot\boldsymbol{r_m})\cos\theta_i

  .. math::
    &R^{12}
    =
    \cos(\boldsymbol{q}\cdot\boldsymbol{r_m})\left[-\sin\phi_i\cos\phi_i(1-\cos\theta_i)\right]-\sin(\boldsymbol{q}\cdot\boldsymbol{r_m})\left[\cos\theta_i + \cos^2\phi_i(1-\cos\theta_i)\right]
    =\\&=
    (1-\cos\theta_i)\left[-\cos(\boldsymbol{q}\cdot\boldsymbol{r_m})\sin\phi_i\cos\phi_i-\sin(\boldsymbol{q}\cdot\boldsymbol{r_m})\cos^2\phi_i\right]-\sin(\boldsymbol{q}\cdot\boldsymbol{r_m})\cos\theta_i
    =\\&=
    -(1-\cos\theta_i)\cos\phi_i\sin(\boldsymbol{q}\cdot\boldsymbol{r_m}+\phi_i)-\sin(\boldsymbol{q}\cdot\boldsymbol{r_m})\cos\theta_i

  .. math::
    R^{13}
    =
    \sin\theta_i(\cos(\boldsymbol{q}\cdot\boldsymbol{r_m})\cos\phi_i - \sin(\boldsymbol{q}\cdot\boldsymbol{r_m})\sin\phi_i)
    =
    \sin\theta_i\cos(\boldsymbol{q}\cdot\boldsymbol{r_m} + \phi_i)

  .. math::
    &R^{21}
    =
    \sin(\boldsymbol{q}\cdot\boldsymbol{r_m})\left[\cos\theta_i + \sin^2\phi_i(1-\cos\theta_i)\right]+\cos(\boldsymbol{q}\cdot\boldsymbol{r_m})\left[-\sin\phi_i\cos\phi_i(1-\cos\theta_i)\right]
    =\\&=
    (1-\cos\theta_i)\left[\sin(\boldsymbol{q}\cdot\boldsymbol{r_m})\sin^2\phi_i-\cos(\boldsymbol{q}\cdot\boldsymbol{r_m})\sin\phi_i\cos\phi_i\right]+\sin(\boldsymbol{q}\cdot\boldsymbol{r_m})\cos\theta_i
    =\\&=
    -(1-\cos\theta_i)\sin\phi_i\cos(\boldsymbol{q}\cdot\boldsymbol{r_m}+\phi_i)+\sin(\boldsymbol{q}\cdot\boldsymbol{r_m})\cos\theta_i

  .. math::
    &R^{22}
    =
    \sin(\boldsymbol{q}\cdot\boldsymbol{r_m})\left[-\sin\phi_i\cos\phi_i(1-\cos\theta_i)\right]+\cos(\boldsymbol{q}\cdot\boldsymbol{r_m})\left[\cos\theta_i + \cos^2\phi_i(1-\cos\theta_i)\right]
    =\\&=
    (1-\cos\theta_i)\left[-\sin(\boldsymbol{q}\cdot\boldsymbol{r_m})\sin\phi_i\cos\phi_i+\cos(\boldsymbol{q}\cdot\boldsymbol{r_m})\cos^2\phi_i\right]+\cos(\boldsymbol{q}\cdot\boldsymbol{r_m})\cos\theta_i
    =\\&=
    (1-\cos\theta_i)\cos\phi_i\cos(\boldsymbol{q}\cdot\boldsymbol{r_m}+\phi_i)+\cos(\boldsymbol{q}\cdot\boldsymbol{r_m})\cos\theta_i

  .. math::
    R^{23}
    =
    \sin\theta_i(\sin(\boldsymbol{q}\cdot\boldsymbol{r_m})\cos\phi_i + \cos(\boldsymbol{q}\cdot\boldsymbol{r_m})\sin\phi_i)
    =
    \sin\theta_i\sin(\boldsymbol{q}\cdot\boldsymbol{r_m} + \phi_i)

  .. math::
    R^{31} = -\cos\phi_i\sin\theta_i

  .. math::
    R^{32} = -\sin\phi_i\sin\theta_i

  .. math::
    R^{33} = \cos\theta_i

.. _user-guide_methods_single-q_examples:

Examples
========

* One spin in the unit cell, :math:`\boldsymbol{q} = (0,0,1)^T`:

  - :math:`\boldsymbol{r}_1 = (0,0,0)`,
    :math:`\theta_1 = 90^{\circ}`,
    :math:`\phi_1 = 0^{\circ}`


.. raw:: html
  :file: ../../../images/single-q-1.html

* One spin in the unit cell, :math:`\boldsymbol{q} = (0,0,1)^T`:

  - :math:`\boldsymbol{r}_1 = (0,0,0)`,
    :math:`\theta_1 = 60^{\circ}`,
    :math:`\phi_1 = 0^{\circ}`


.. raw:: html
  :file: ../../../images/single-q-2.html

* One spin in the unit cell, :math:`\boldsymbol{q} = (0,0,1)^T`:

  - :math:`\boldsymbol{r}_1 = (0,0,0)`,
    :math:`\theta_1 = 60^{\circ}`,
    :math:`\phi_1 = 45^{\circ}`

.. raw:: html
  :file: ../../../images/single-q-3.html

* One spin in the unit cell, :math:`\boldsymbol{q} = (0,1,0)^T`:

  - :math:`\boldsymbol{r}_1 = (0,0,0)`,
    :math:`\theta_1 = 30^{\circ}`,
    :math:`\phi_1 = 0^{\circ}`

.. raw:: html
  :file: ../../../images/single-q-4.html

* Two spins in the unit cell, :math:`\boldsymbol{q} = (0,1,0)^T`:

  - :math:`\boldsymbol{r}_1 = (0,0,0)`,
    :math:`\theta_1 = 30^{\circ}`,
    :math:`\phi_1 = 0^{\circ}`
  - :math:`\boldsymbol{r}_2 = (\frac{1}{2},\frac{1}{2},\frac{1}{2})`,
    :math:`\theta_2 = 20^{\circ}`,
    :math:`\phi_2 = 45^{\circ}`


.. raw:: html
  :file: ../../../images/single-q-5.html

* Two spins in the unit cell, :math:`\boldsymbol{q} = (1,0,0)^T`:

  - :math:`\boldsymbol{r}_1 = (0,0,0)`,
    :math:`\theta_1 = 150^{\circ}`,
    :math:`\phi_1 = 0^{\circ}`
  - :math:`\boldsymbol{r}_2 = (0,\frac{1}{2},0)`,
    :math:`\theta_2 = 30^{\circ}`,
    :math:`\phi_2 =180^{\circ}`

.. raw:: html
  :file: ../../../images/single-q-6.html
