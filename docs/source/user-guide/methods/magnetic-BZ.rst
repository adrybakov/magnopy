.. _user-guide_methods_magnetic-BZ:

***********************
Magnetic Brillouin Zone
***********************

.. dropdown:: Notation used on this page

  For the full set of notation rules, see :ref:`user-guide_methods_notation`.

  * .. include:: page-notations/exchange-tensor.inc

.. note::
  This section introduces two-dimensional Magnetic Brillouin Zones. The extension to
  one and three-dimensions is straightforward.

=================================
The Magnetic Brillouin Zone (MBZ)
=================================

The requirement that the spiral wave-vector :math:`\boldsymbol{q}` be a reciprocal lattice
vector means that there must exist a positive integer :math:`M_q` such that
:math:`M_q\,\boldsymbol{q}\,=\,\boldsymbol{G}_\parallel`. We define new Bravais lattice vectors
:math:`\boldsymbol{g}_\perp,\,\boldsymbol{g}_\parallel` and reshape the pristine Brillouin Zone (PBZ) so that the
BZ area is maintained

.. math::
  \|\boldsymbol{b}_1\,\times\boldsymbol{b}_2\|= \|\boldsymbol{g}_\perp\,\times\boldsymbol{g}_\parallel \|

Then the reciprocal wave-vector coordinates are
:math:`\boldsymbol{k}=k_\parallel\,\boldsymbol{g}_\parallel+k_\perp\,\boldsymbol{k}_\perp=(\boldsymbol{k}_\parallel,\,\boldsymbol{k}_\perp)` .


The MBZ is generated by making :math:`M_q-1` copies of the PBZ and attaching them to
its left and right, in a way that the :math:`\Gamma` -point is centred. The slice number is
:math:`n=-\overline{M},\,\cdots ,\,\overline{M}` with :math:`\overline{M}=\frac{M_q-1}{2}` . The wave-vectors are
:math:`\boldsymbol{k}_n=\boldsymbol{k}+n\,\boldsymbol{q}=(\boldsymbol{k}_\parallel+n\boldsymbol{q},\,\boldsymbol{k}_\perp)=(\boldsymbol{k}_\parallel,\,\boldsymbol{k}_\perp)_n` .
Then each wave vector :math:`\boldsymbol{k}_n` has an opposite :math:`-\boldsymbol{k}_{-n}` .
We use the notation :math:`A(\pm \boldsymbol{k}_{\pm n})=A_{\pm n}(\pm \boldsymbol{k})` for later convenience.

The end result is that magnitudes fulfill periodic conditions :math:`A^\nu_{n+M_q}(\boldsymbol{k})=A^\nu_{n}(\boldsymbol{k})`
within the MBZ. As a consequence, we extend the reciprocal-space sums as follows

.. math::
  \sum_{\boldsymbol{k}\in BZ} \rightarrow \frac{1}{M_q}\sum_{n=-\overline{M}}^{\overline{M}}\,\,\sum_{\boldsymbol{k}\in BZ}

Let the system size be :math:`M_1\times M_2=M_q M_\parallel \times M_\perp` . Then the Hamiltonian separates into
:math:`(M_\parallel \times M_\perp)^2` boxes, each of dimensions :math:`M_q^2` .

.. math::
  {\cal H}^{LSWT}
    =&E^{QC-LSWT}&\\
    &+
    \frac{1}{2\,M_q}\,\sum_{\nu, n,\boldsymbol{k}}\,
    \Big(&B_{n+\nu}(\boldsymbol{k})^\dagger\,T^\nu_n(\boldsymbol{k})\,B_{n}(\boldsymbol{k})
    +\tilde{B}_{-(n+\nu)}(-\boldsymbol{k})\,T^{-\nu}_{-n}(-\boldsymbol{k})^\dagger\,\tilde{B}_{-n}(-\boldsymbol{k})^\dagger\\
    &&+
    \tilde{B}_{-(n+\nu)}(-\boldsymbol{k})\,\Delta_n^\nu(\boldsymbol{k})\,B_n(\boldsymbol{k})
    +B_n(\boldsymbol{k})^\dagger\,\Delta_n^\nu(\boldsymbol{k})^\dagger\,
    \tilde{B}_{-(n+\nu)}(\boldsymbol{k})^\dagger\Big)

===============
MBZ Hamiltonian
===============

We organize the block boson fields as follows

.. math::
  {\boldsymbol B}(\boldsymbol{k})=\begin{pmatrix} B_{-\overline{M}}(\boldsymbol{k})\\B_{-\overline{M}+1}(\boldsymbol{k})\\\vdots\\
  B_\overline{M}(\boldsymbol{k})\end{pmatrix}, \,\,\,
  \boldsymbol{\tilde{B}(\boldsymbol{k})}^\dagger=\begin{pmatrix} \tilde{B}_{-\overline{M}}(\boldsymbol{k})^\dagger\\
  \tilde{B}_{-\overline{M}+1}(\boldsymbol{k})^\dagger\\\vdots\\\tilde{B}_\overline{M}(\boldsymbol{k})^\dagger\end{pmatrix}

and the tridiagonal-block-like kinetic and pairing pieces of the Hamiltonian

.. math::
  \boldsymbol{T}(\boldsymbol{k})=
  \begin{pmatrix}
    \tilde{T}^0_{-\overline{M}}(\boldsymbol{k})       & \tilde{T}^{-1}_{-\overline{M}+1}(\boldsymbol{k}) &
    \tilde{T}^{-2}_{-\overline{M}+2}(\boldsymbol{k})  & 0                                                &
    0                                                 & \cdots                                           &
    0                                                 & 0                                                &
    \tilde{T}^1_{\overline{M}-1}(\boldsymbol{k})      & \tilde{T}^1_{-\overline{M}}(\boldsymbol{k})      \\
    \tilde{T}^1_{-\overline{M}}(\boldsymbol{k})       & \tilde{T}^{0}_{-\overline{M}+1}(\boldsymbol{k})  &
    \tilde{T}^{-1}_{-\overline{M}+2}(\boldsymbol{k})  & \tilde{T}^{-2}_{-\overline{M}+3}(\boldsymbol{k}) &
    0                                                 & \cdots                                           &
    0                                                 & 0                                                &
    0                                                 & \tilde{T}^2_{-\overline{M}}(\boldsymbol{k})      \\
    \tilde{T}^2_{-\overline{M}}(\boldsymbol{k})       & \tilde{T}^{1}_{-\overline{M}+1}(\boldsymbol{k})  &
    \tilde{T}^{0}_{-\overline{M}+2}(\boldsymbol{k})   & \tilde{T}^{1}_{-\overline{M}+3}(\boldsymbol{k})  &
    \tilde{T}^{1}_{-\overline{M}+4}(\boldsymbol{k})   & \cdots                                           &
    0                                                 & 0                                                &
    0                                                 & 0                                                \\
    0                                                 & \tilde{T}^{2}_{-\overline{M}+1}(\boldsymbol{k})  &
    \tilde{T}^{1}_{-\overline{M}+2}(\boldsymbol{k})   & \tilde{T}^{0}_{-\overline{M}+3}(\boldsymbol{k})  &
    \tilde{T}^{-1}_{-\overline{M}+4}(\boldsymbol{k})  & \cdots                                           &
    0                                                 & 0                                                &
    0                                                 & 0                                                \\
    0                                                 & 0                                                &
    \tilde{T}^{2}_{-\overline{M}+2}(\boldsymbol{k})   & \tilde{T}^{1}_{-\overline{M}+3}(\boldsymbol{k})  &
    \tilde{T}^{0}_{-\overline{M}+4}(\boldsymbol{k})   & \cdots                                           &
    0                                                 & 0                                                &
    0                                                 & 0                                                \\
    \vdots                                            & \vdots                                           &
    \vdots                                            & \vdots                                           &
    \vdots                                            & \vdots                                           &
    \vdots                                            & \vdots                                           \\
    0                                                 & 0                                                &
    0                                                 & 0                                                &
    0                                                 & \cdots                                           &
    \tilde{T}^{0}_{-\overline{M}-3}(\boldsymbol{k})   & \tilde{T}^{-1}_{-\overline{M}-2}(\boldsymbol{k}) &
    \tilde{T}^{-2}_{-\overline{M}-1}(\boldsymbol{k})  & 0                                                \\
    0                                                 & 0                                                &
    0                                                 & 0                                                &
    0                                                 & \cdots                                           & \tilde{T}^{1}_{-\overline{M}-3}(\boldsymbol{k})   & \tilde{T}^{0}_{-\overline{M}-2}(\boldsymbol{k})  & \tilde{T}^{-1}_{-\overline{M}-1}(\boldsymbol{k})  & \tilde{T}^{-2}_{-\overline{M}}(\boldsymbol{k})   \\
    \tilde{T}^{-2}_{-\overline{M}}(\boldsymbol{k})    & 0                                                &
    0                                                 & 0                                                &
    0                                                 & \cdots                                           &
    \tilde{T}^{2}_{-\overline{M}-3}(\boldsymbol{k})   & \tilde{T}^{1}_{-\overline{M}-2}(\boldsymbol{k})  &
    \tilde{T}^{0}_{-\overline{M}-1}(\boldsymbol{k})   & \tilde{T}^{-1}_{-\overline{M}}(\boldsymbol{k})   \\
    \tilde{T}^{-1}_{-\overline{M}}(\boldsymbol{k})    & \tilde{T}^{-2}_{-\overline{M}+1}(\boldsymbol{k}) &
    0                                                 & 0                                                &
    0                                                 & \cdots                                           &
    0                                                 & \tilde{T}^{2}_{-\overline{M}-2}(\boldsymbol{k})  & \tilde{T}^{1}_{-\overline{M}-1}(\boldsymbol{k})   & \tilde{T}^{0}_{-\overline{M}}(\boldsymbol{k})
  \end{pmatrix}

.. math::
  \boldsymbol{\Delta}(\boldsymbol{k})=
  \begin{pmatrix}
    \Delta^0_{-\overline{M}}(\boldsymbol{k})       & \Delta^{-1}_{-\overline{M}+1}(\boldsymbol{k}) &
    \Delta^{-2}_{-\overline{M}+2}(\boldsymbol{k})  & 0                                             &
    0                                              & \cdots                                        &
    0                                              & 0                                             &
    \Delta^1_{\overline{M}-1}(\boldsymbol{k})      & \Delta^1_{-\overline{M}}(\boldsymbol{k})      \\
    \Delta^1_{-\overline{M}}(\boldsymbol{k})       & \Delta^{0}_{-\overline{M}+1}(\boldsymbol{k})  &
    \Delta^{-1}_{-\overline{M}+2}(\boldsymbol{k})  & \Delta^{-2}_{-\overline{M}+3}(\boldsymbol{k}) &
    0                                              & \cdots                                        &
    0                                              & 0                                             &
    0                                              & \Delta^2_{-\overline{M}}(\boldsymbol{k})      \\
    \Delta^2_{-\overline{M}}(\boldsymbol{k})       & \Delta^{1}_{-\overline{M}+1}(\boldsymbol{k})  &
    \Delta^{0}_{-\overline{M}+2}(\boldsymbol{k})   & \Delta^{1}_{-\overline{M}+3}(\boldsymbol{k})  &
    \Delta^{1}_{-\overline{M}+4}(\boldsymbol{k})   & \cdots                                        &
    0                                              & 0                                             &
    0                                              & 0                                             \\
    0                                              & \Delta^{2}_{-\overline{M}+1}(\boldsymbol{k})  &
    \Delta^{1}_{-\overline{M}+2}(\boldsymbol{k})   & \Delta^{0}_{-\overline{M}+3}(\boldsymbol{k})  &
    \Delta^{-1}_{-\overline{M}+4}(\boldsymbol{k})  & \cdots                                        &
    0                                              & 0                                             &
    0                                              & 0                                             \\
    0                                              & 0                                             &
    \Delta^{2}_{-\overline{M}+2}(\boldsymbol{k})   & \Delta^{1}_{-\overline{M}+3}(\boldsymbol{k})  &
    \Delta^{0}_{-\overline{M}+4}(\boldsymbol{k})   & \cdots                                        &
    0                                              & 0                                             &
    0                                              & 0                                             \\
    \vdots                                         & \vdots                                        &
    \vdots                                         & \vdots                                        &
    \vdots                                         & \vdots                                        &
    \vdots                                         & \vdots                                        \\
    0                                              & 0                                             &
    0                                              & 0                                             &
    0                                              & \cdots                                        &
    \Delta^{0}_{-\overline{M}-3}(\boldsymbol{k})   & \Delta^{-1}_{-\overline{M}-2}(\boldsymbol{k}) &
    \Delta^{-2}_{-\overline{M}-1}(\boldsymbol{k})  & 0                                             \\
    0                                              & 0                                             &
    0                                              & 0                                             &
    0                                              & \cdots                                        &
    \Delta^{1}_{-\overline{M}-3}(\boldsymbol{k})   & \Delta^{0}_{-\overline{M}-2}(\boldsymbol{k})  &
    \Delta^{-1}_{-\overline{M}-1}(\boldsymbol{k})  & \Delta^{-2}_{-\overline{M}}(\boldsymbol{k})   \\
    \Delta^{-2}_{-\overline{M}}(\boldsymbol{k})    & 0                                             &
    0                                              & 0                                             &
    0                                              & \cdots                                        &
    \Delta^{2}_{-\overline{M}-3}(\boldsymbol{k})   & \Delta^{1}_{-\overline{M}-2}(\boldsymbol{k})  &
    \Delta^{0}_{-\overline{M}-1}(\boldsymbol{k})   & \Delta^{-1}_{-\overline{M}}(\boldsymbol{k})   \\
    \Delta^{-1}_{-\overline{M}}(\boldsymbol{k})    & \Delta^{-2}_{-\overline{M}+1}(\boldsymbol{k}) &
    0                                              & 0                                             &
    0                                              & \cdots                                        &
    0                                              & \Delta^{2}_{-\overline{M}-2}(\boldsymbol{k})  &
    \Delta^{1}_{-\overline{M}-1}(\boldsymbol{k})   & \Delta^{0}_{-\overline{M}}(\boldsymbol{k})
  \end{pmatrix}

The LSWT Hamiltonian reduces in this way to a conventional BCS-like form

.. math::
  {\cal H}^{LSWT}=&E^{QC-LSWT}+\frac{1}{2\,M_q}\,\sum_{\boldsymbol{k}}\,
  \begin{pmatrix}{\boldsymbol B}(\boldsymbol{k})^\dagger &\boldsymbol{\tilde{\cal B}}(\boldsymbol{-k})\end{pmatrix}\,
  \begin{pmatrix}   \boldsymbol{T}(\boldsymbol{k})   &  \boldsymbol{\Delta}(\boldsymbol{k})^\dagger  \\
                    \boldsymbol{\Delta}(\boldsymbol{k})  &  \boldsymbol{T}(\boldsymbol{-k})^*
  \end{pmatrix}\,
  \begin{pmatrix} {\boldsymbol B}(\boldsymbol{k})  \\  \boldsymbol{\tilde{\cal B}}(\boldsymbol{-k})^\dagger \end{pmatrix}
  \\=&
  E^{QC-LSWT}+\frac{1}{2\,M_q}\,\sum_{\boldsymbol{k}}\,
  \boldsymbol{\cal B}(\boldsymbol{k})^\dagger\,\boldsymbol{\cal H}(\boldsymbol{k})\,\boldsymbol{\cal B}(\boldsymbol{k})

The above Hamiltonian may not always be diagonzalized as will discussed in the next
:ref:`section <user-guide_methods_bogoliubov>`. Whenever the diagonalization is possible the resulting spin-wave
dispersion relation corresponds to a single band in the MBZ, that is folded to :math:`M_q` bands in the PBZ.
