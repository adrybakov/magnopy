.. _user-guide_methods_energy-classic:

******************************************
Energy minima of the classical Hamiltonian
******************************************

.. dropdown:: Notation used on this page

  For the full set of notation rules, see :ref:`user-guide_methods_notation`.

  * .. include:: ../page-notations/reference-frame.inc
  * .. include:: ../page-notations/transpose-complex-conjugate.inc
  * .. include:: ../page-notations/exchange-tensor.inc

Energy minima are characterized by vectors :math:`\ket{S_{mi}^0}=S_i\,\ket{f_{mi}}`,
having the same coordinates for all unit cells

.. math::
  ^{sf}\boldsymbol{S_{mi}}=S_i\,\begin{pmatrix}0\\0\\1\end{pmatrix}

This specificity enables us to largely simplify the expressions for the exchange and the Zeeman
parts of the classical energy. First, only a few matrix elements survive the matrix products.
Second, the :math:`m`-summations can be carried out explicitly leading to Kronecker deltas.

===============
Exchange energy
===============

.. include:: exchange-energy.inc

=====================
Magnetic field energy
=====================

.. include:: zeeman.inc

============================================
Parameter dependence of the classical energy
============================================

The expressions above for the exchange and Zeeman contributions demonstrate that
to the classical energy at energy minima is a function
:math:`E(\boldsymbol{\hat{n}},\,\boldsymbol{q},\theta_i,\,\phi_i)`
of only a few parameters: the cone axis vector :math:`\boldsymbol{\hat{n}}`, the spiral
wave-vector :math:`\boldsymbol{q}`, and all the angles :math:`\theta_i,\,\phi_i`.
The energy-minima configurations are therefore obtained by minimizing :math:`E` with
respect to those parameters.

Furthermore, the Kronecker delta functions indicate the fact that the expressions
for the minimum energy depend non-analytically on the higher harmonics generated by
the non-commuting properties of the exchange and the rotation matrices. This forces
to distinguish among three different cases.

================
Three main cases
================

Base on the equation for the total energy we can classify all possible states into three
big groups based on the harmonics that contribute to the energy in each of them.

1.  All harmonics contribute to the total energy if the spiral vector
    :math:`\boldsymbol{q} = \boldsymbol{G}`. This is **ferromagnetic** case where no
    spiral is formed. Note, that the each spin in the unit cell can be oriented in any
    direction, but all cells are replicas of each other.

2.  Only the zeroth- and second-order terms contribute to the energy if the spiral
    vector :math:`\boldsymbol{q}=\boldsymbol{G}/2` and
    :math:`\boldsymbol{q}\ne\boldsymbol{G}`. This is the **anti-ferromagnetic** case
    where the spins can rotate between two different cells, but the angle of rotation
    is :math:`n_m \pi/2`.

3. Only the zero harmonic contributes to the energy if the spiral vector
   :math:`\boldsymbol{q}\neq \boldsymbol{G},\,\boldsymbol{G}/2`. This is the true
   **spiral** case where the spins rotate between the cells.


In the three following pages we consider minimization for each case separately:

.. toctree::
  :maxdepth: 1
  :caption: Minimization strategy

  ferromagnetic
  antiferromagnetic
  spiral
